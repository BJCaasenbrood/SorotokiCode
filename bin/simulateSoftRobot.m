%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% -- name --
%   "simulateSoftRobot.m"
%       created by ir. Brandon Caasenbrood (14/05/19)    
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear; clc; close all;

ShowSimulation = true;
%% init. states
l0   = 0.064;               % undeformed length (m)
q0   = [0.064,25,0];      % initial deformations
dq0  = [0,0,1500];          % initial deform. rates
lam0 = [0,0];               % initial creep strains

%% ordinary diff. solver (4th order runge kutta)
dt = 1e-3; 
tspan = 0:dt:3.5; 

disp('* simulating dynamics...')
[t,x] = ode45(@(t,x) DifferentialEq(t,x),tspan,[q0 dq0,lam0]);
%[t,x] = oderk(@(t,x) DifferentialEq(t,x),tspan,[q0 dq0,lam0]);

%% strip solution matrix x
Elong = (l0 - x(:,1))/l0;
KxDeg = l0.*x(:,2)/(pi/180);
KyDeg = l0.*x(:,3)/(pi/180);

% recover end-effector
p = EndEffector(x(:,1),x(:,2),x(:,3));
%% show state trajectories
figure(10); subplot(3,1,1);
plot(t,Elong,'linewidth',1); ylabel('l - l_0')
subplot(3,1,2);
plot(t,KxDeg,'linewidth',1); ylabel('\kappa_x')
subplot(3,1,3);
plot(t,KyDeg,'linewidth',1); ylabel('\kappa_y')

xlabel('time (s)')

function dx = DifferentialEq(t,x)
m   = 0.0494;
beta0 = 1e-3;
g   = 9.81;
r   = 0.02;
l0  = 0.064;
de  = 0.1;
db  = 5.93e-7;
kb1 = 0.42292;
kb2 = 0.39552;
kb3 = -0.21293;
ke1 = 2234;
ke2 = 1740;
ke3 = -45.55;
Ixx = (m*r^2)/(2*l0); 
Iyy = (m*r^2)/(4*l0); 
Izz = (m*r^2)/(4*l0); 

Ae = -28.356;
Be = -0.0018193;
Ce = 0.015346;

dx  = zeros(6,1);

l = x(1);
kx = x(2);
ky = x(3);
dl = x(4);
dkx = x(5);
dky = x(6);

q  = [l; kx; ky];
dq = [dl; dkx;dky];

M = zeros(3,3);
C = zeros(3,3);
N = zeros(3,1);
F = zeros(3,1);

% if (kx^2 + ky^2) < 0.01
%     kx = abs(kx) + 0.01; 
%     ky = abs(ky) + 0.01; 
% end

M(1,1) = (2*m)/(kx^2 + ky^2) - (2*m*sin(l*(kx^2 + ky^2)^(1/2)))/(l*(kx^2 + ky^2)^(3/2));
M(1,2) = (3*kx*m*sin(l*(kx^2 + ky^2)^(1/2)))/(l*(kx^2 + ky^2)^(5/2)) - (kx*m*cos(l*(kx^2 + ky^2)^(1/2)))/(kx^2 + ky^2)^2 - (2*kx*m)/(kx^2 + ky^2)^2;
M(1,3) = (3*ky*m*sin(l*(kx^2 + ky^2)^(1/2)))/(l*(kx^2 + ky^2)^(5/2)) - (ky*m*cos(l*(kx^2 + ky^2)^(1/2)))/(kx^2 + ky^2)^2 - (2*ky*m)/(kx^2 + ky^2)^2;
M(2,1) = M(1,2);
M(2,2) = (3*m*sin(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 3*kx^2*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 24*kx^2*m*sin(l*(kx^2 + ky^2)^(1/2)) + 18*l*m*(kx^2 + ky^2)^(3/2) + 6*kx^2*l*m*(kx^2 + ky^2)^(1/2) - 3*Iyy*ky^4*l*sin(2*l*(kx^2 + ky^2)^(1/2)) + 4*Iyy*kx^4*l^4*(kx^2 + ky^2)^(3/2) + 6*Iyy*ky^4*l^2*(kx^2 + ky^2)^(1/2) + 18*Izz*ky^2*l^2*(kx^2 + ky^2)^(3/2) + 4*kx^2*l^3*m*(kx^2 + ky^2)^(3/2) - 24*Ixx*kx^2*ky^2*l*sin(l*(kx^2 + ky^2)^(1/2)) - 3*Ixx*kx^2*ky^2*l*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*kx^2*ky^2*l*sin(l*(kx^2 + ky^2)^(1/2)) + 6*Ixx*kx^2*ky^2*l^2*(kx^2 + ky^2)^(1/2) + 4*Ixx*kx^2*ky^2*l^4*(kx^2 + ky^2)^(3/2) - 24*Izz*ky^2*l*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 3*Izz*ky^2*l*sin(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 24*kx^2*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*Ixx*kx^2*ky^2*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 24*Iyy*kx^2*ky^2*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2))/(12*l*(kx^2 + ky^2)^(7/2));
M(2,3) = (6*kx*ky*l*m*(kx^2 + ky^2)^(1/2) - 3*kx*ky*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*kx*ky*m*sin(l*(kx^2 + ky^2)^(1/2)) - 18*Izz*kx*ky*l^2*(kx^2 + ky^2)^(3/2) + 4*kx*ky*l^3*m*(kx^2 + ky^2)^(3/2) - 12*Ixx*kx*ky^3*l*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Ixx*kx^3*ky*l*sin(l*(kx^2 + ky^2)^(1/2)) + 3*Ixx*kx^3*ky*l*sin(2*l*(kx^2 + ky^2)^(1/2)) + 12*Iyy*kx*ky^3*l*sin(l*(kx^2 + ky^2)^(1/2)) - 12*Iyy*kx^3*ky*l*sin(l*(kx^2 + ky^2)^(1/2)) + 3*Iyy*kx*ky^3*l*sin(2*l*(kx^2 + ky^2)^(1/2)) - 6*Ixx*kx^3*ky*l^2*(kx^2 + ky^2)^(1/2) + 4*Ixx*kx*ky^3*l^4*(kx^2 + ky^2)^(3/2) - 6*Iyy*kx*ky^3*l^2*(kx^2 + ky^2)^(1/2) + 4*Iyy*kx^3*ky*l^4*(kx^2 + ky^2)^(3/2) + 24*Izz*kx*ky*l*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 3*Izz*kx*ky*l*sin(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 12*Ixx*kx*ky^3*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 12*Ixx*kx^3*ky*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 12*Iyy*kx*ky^3*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 12*Iyy*kx^3*ky*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*kx*ky*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2))/(12*l*(kx^2 + ky^2)^(7/2));
M(3,1) = M(1,3);
M(3,2) = M(2,3);
M(3,3) = (3*m*sin(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 3*ky^2*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 24*ky^2*m*sin(l*(kx^2 + ky^2)^(1/2)) + 18*l*m*(kx^2 + ky^2)^(3/2) + 6*ky^2*l*m*(kx^2 + ky^2)^(1/2) - 3*Ixx*kx^4*l*sin(2*l*(kx^2 + ky^2)^(1/2)) + 6*Ixx*kx^4*l^2*(kx^2 + ky^2)^(1/2) + 4*Ixx*ky^4*l^4*(kx^2 + ky^2)^(3/2) + 18*Izz*kx^2*l^2*(kx^2 + ky^2)^(3/2) + 4*ky^2*l^3*m*(kx^2 + ky^2)^(3/2) + 24*Ixx*kx^2*ky^2*l*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*kx^2*ky^2*l*sin(l*(kx^2 + ky^2)^(1/2)) - 3*Iyy*kx^2*ky^2*l*sin(2*l*(kx^2 + ky^2)^(1/2)) + 6*Iyy*kx^2*ky^2*l^2*(kx^2 + ky^2)^(1/2) + 4*Iyy*kx^2*ky^2*l^4*(kx^2 + ky^2)^(3/2) - 24*Izz*kx^2*l*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 3*Izz*kx^2*l*sin(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 24*ky^2*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 24*Ixx*kx^2*ky^2*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*Iyy*kx^2*ky^2*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2))/(12*l*(kx^2 + ky^2)^(7/2));
C(1,1) = ((l*(3*dkx*kx*m*sin(l*(kx^2 + ky^2)^(1/2)) - dl*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 3*dky*ky*m*sin(l*(kx^2 + ky^2)^(1/2))))/(kx^2 + ky^2)^(5/2) + (dl*m*sin(l*(kx^2 + ky^2)^(1/2)))/(kx^2 + ky^2)^(3/2))/l^2 - (2*dkx*kx*m*(kx^2 + ky^2)^(1/2) + 2*dky*ky*m*(kx^2 + ky^2)^(1/2) + dkx*kx*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + dky*ky*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2))/(kx^2 + ky^2)^(5/2);
C(1,2) = -(72*dkx*l^2*m*(kx^2 + ky^2)^(3/2) + 48*dkx*kx^2*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dkx*ky^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 3*dkx*ky^2*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 18*dkx*l*m*(kx^2 + ky^2)^(3/2) - 360*dkx*kx^2*l^2*m*(kx^2 + ky^2)^(1/2) + 8*dkx*kx^2*l^3*m*(kx^2 + ky^2)^(3/2) - 48*dkx*l^2*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(3/2) - 24*dkx*kx^4*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dkx*kx^4*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dky*kx*ky*m*sin(l*(kx^2 + ky^2)^(1/2)) + 3*dky*kx*ky*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 30*dkx*kx^2*l*m*(kx^2 + ky^2)^(1/2) + 72*dl*kx*l^2*m*(kx^2 + ky^2)^(3/2) - 12*dkx*l*m*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(3/2) + 48*dkx*l*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(3/2) + 12*Iyy*dkx*kx^4*l^4*(kx^2 + ky^2)^(3/2) + 288*dkx*kx^2*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 72*dl*kx^3*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 72*dkx*ky^2*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dkx*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dkx*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dkx*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dkx*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 360*dky*kx*ky*l*m*sin(l*(kx^2 + ky^2)^(1/2)) + 336*dkx*kx^2*l^2*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(1/2) - 24*dkx*kx^2*ky^2*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dkx*kx^2*ky^2*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) - 360*dky*kx*ky*l^2*m*(kx^2 + ky^2)^(1/2) + 8*dky*kx*ky*l^3*m*(kx^2 + ky^2)^(3/2) + 12*Ixx*dky*kx*ky^3*l^4*(kx^2 + ky^2)^(3/2) + 12*Iyy*dky*kx^3*ky*l^4*(kx^2 + ky^2)^(3/2) - 72*dl*kx*ky^2*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 12*Ixx*dky*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Ixx*dky*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Iyy*dky*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 12*Iyy*dky*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 12*dkx*kx^2*l*m*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) + 48*dkx*kx^2*l*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(1/2) - 48*dl*kx*l^2*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(3/2) + 12*Ixx*dkx*kx^2*ky^2*l^4*(kx^2 + ky^2)^(3/2) - 24*dky*kx*ky^3*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dky*kx^3*ky*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dky*kx*ky^3*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dky*kx^3*ky*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) - 30*dky*kx*ky*l*m*(kx^2 + ky^2)^(1/2) + 12*Iyy*dkx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) - 12*Izz*dkx*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(3/2) + 48*Izz*dkx*ky^2*l^2*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(3/2) + 336*dky*kx*ky*l^2*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(1/2) - 12*Ixx*dky*kx^3*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) - 12*Iyy*dky*kx*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) + 12*Ixx*dkx*kx^2*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) + 12*dky*kx*ky*l*m*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) + 48*dky*kx*ky*l*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(1/2) + 12*Izz*dky*kx*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(3/2) - 48*Izz*dky*kx*ky*l^2*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(3/2))/(24*l^2*(kx^2 + ky^2)^(7/2));
C(1,3) = -(72*dky*l^2*m*(kx^2 + ky^2)^(3/2) + 24*dky*kx^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 3*dky*kx^2*m*sin(2*l*(kx^2 + ky^2)^(1/2)) + 48*dky*ky^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 18*dky*l*m*(kx^2 + ky^2)^(3/2) - 360*dky*ky^2*l^2*m*(kx^2 + ky^2)^(1/2) + 8*dky*ky^2*l^3*m*(kx^2 + ky^2)^(3/2) - 48*dky*l^2*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(3/2) - 24*dky*ky^4*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dky*ky^4*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dkx*kx*ky*m*sin(l*(kx^2 + ky^2)^(1/2)) + 3*dkx*kx*ky*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 30*dky*ky^2*l*m*(kx^2 + ky^2)^(1/2) + 72*dl*ky*l^2*m*(kx^2 + ky^2)^(3/2) - 12*dky*l*m*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(3/2) + 48*dky*l*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(3/2) + 12*Ixx*dky*ky^4*l^4*(kx^2 + ky^2)^(3/2) - 72*dky*kx^2*l*m*sin(l*(kx^2 + ky^2)^(1/2)) + 288*dky*ky^2*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 72*dl*ky^3*l*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dky*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dky*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dky*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dky*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 360*dkx*kx*ky*l*m*sin(l*(kx^2 + ky^2)^(1/2)) + 336*dky*ky^2*l^2*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(1/2) - 24*dky*kx^2*ky^2*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dky*kx^2*ky^2*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) - 360*dkx*kx*ky*l^2*m*(kx^2 + ky^2)^(1/2) + 8*dkx*kx*ky*l^3*m*(kx^2 + ky^2)^(3/2) + 12*Ixx*dkx*kx*ky^3*l^4*(kx^2 + ky^2)^(3/2) + 12*Iyy*dkx*kx^3*ky*l^4*(kx^2 + ky^2)^(3/2) - 72*dl*kx^2*ky*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 12*Ixx*dkx*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Ixx*dkx*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Iyy*dkx*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 12*Iyy*dkx*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 12*dky*ky^2*l*m*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) + 48*dky*ky^2*l*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(1/2) - 48*dl*ky*l^2*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(3/2) + 12*Iyy*dky*kx^2*ky^2*l^4*(kx^2 + ky^2)^(3/2) - 24*dkx*kx*ky^3*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dkx*kx^3*ky*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dkx*kx*ky^3*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dkx*kx^3*ky*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) - 30*dkx*kx*ky*l*m*(kx^2 + ky^2)^(1/2) + 12*Ixx*dky*kx^4*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) - 12*Izz*dky*kx^2*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(3/2) + 48*Izz*dky*kx^2*l^2*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(3/2) + 336*dkx*kx*ky*l^2*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(1/2) - 12*Ixx*dkx*kx^3*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) - 12*Iyy*dkx*kx*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) + 12*Iyy*dky*kx^2*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) + 12*dkx*kx*ky*l*m*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(1/2) + 48*dkx*kx*ky*l*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(1/2) + 12*Izz*dkx*kx*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2))^2*(kx^2 + ky^2)^(3/2) - 48*Izz*dkx*kx*ky*l^2*sin((l*(kx^2 + ky^2)^(1/2))/2)^2*(kx^2 + ky^2)^(3/2))/(24*l^2*(kx^2 + ky^2)^(7/2));
C(2,1) = (48*dkx*kx^2*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dkx*ky^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 3*dkx*ky^2*m*sin(2*l*(kx^2 + ky^2)^(1/2)) + 8*dkx*kx^2*l^3*m*(kx^2 + ky^2)^(3/2) - 72*dl*kx*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 24*dkx*kx^4*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dkx*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*dkx*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*dky*kx*ky*m*sin(l*(kx^2 + ky^2)^(1/2)) + 3*dky*kx*ky*m*sin(2*l*(kx^2 + ky^2)^(1/2)) + 48*dl*kx*l^2*m*(kx^2 + ky^2)^(3/2) + 12*Iyy*dkx*kx^4*l^4*(kx^2 + ky^2)^(3/2) + 6*Iyy*dkx*ky^4*l^2*(kx^2 + ky^2)^(1/2) + 18*Izz*dkx*ky^2*l^2*(kx^2 + ky^2)^(3/2) - 24*Ixx*dkx*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dkx*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dkx*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dkx*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 18*Izz*dky*kx*ky*l^2*(kx^2 + ky^2)^(3/2) - 24*dkx*kx^2*ky^2*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) + 8*dky*kx*ky*l^3*m*(kx^2 + ky^2)^(3/2) - 24*dkx*kx^2*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 6*dkx*kx^2*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*dl*kx*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*dl*kx*l^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^2 - 6*Ixx*dky*kx^3*ky*l^2*(kx^2 + ky^2)^(1/2) + 12*Ixx*dky*kx*ky^3*l^4*(kx^2 + ky^2)^(3/2) - 6*Iyy*dky*kx*ky^3*l^2*(kx^2 + ky^2)^(1/2) + 12*Iyy*dky*kx^3*ky*l^4*(kx^2 + ky^2)^(3/2) - 6*Iyy*dkx*ky^4*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 24*Izz*dkx*ky^2*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*Izz*dkx*ky^2*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 72*dl*kx*l*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 12*Ixx*dky*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Ixx*dky*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Iyy*dky*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 12*Iyy*dky*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 6*Ixx*dkx*kx^2*ky^2*l^2*(kx^2 + ky^2)^(1/2) + 12*Ixx*dkx*kx^2*ky^2*l^4*(kx^2 + ky^2)^(3/2) - 24*dky*kx*ky^3*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dky*kx^3*ky*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) + 72*dl*kx*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Ixx*dkx*kx^2*ky^2*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 24*dky*kx*ky*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 6*dky*kx*ky*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*Izz*dky*kx*ky*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Izz*dky*kx*ky*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*Ixx*dky*kx^3*ky*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Iyy*dky*kx*ky^3*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2))/(24*l^2*(kx^2 + ky^2)^(7/2));
C(2,2) = -(36*dkx*kx^3*l^2*m*(kx^2 + ky^2)^(1/2) + 16*dkx*kx^3*l^4*m*(kx^2 + ky^2)^(3/2) - 8*dl*kx^2*l^3*m*(kx^2 + ky^2)^(5/2) - 9*Iyy*dky*ky^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 72*Izz*dky*ky^5*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 9*Izz*dky*ky^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*dkx*kx^5*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dl*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) - 6*dl*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) - 48*dl*kx^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 24*dl*ky^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 3*dl*ky^2*m*sin(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 36*Izz*dky*ky*l^3*(kx^2 + ky^2)^(5/2) + 60*dkx*kx*l^2*m*(kx^2 + ky^2)^(3/2) - 8*dkx*kx*l^4*m*(kx^2 + ky^2)^(5/2) + 72*dky*ky*l^2*m*(kx^2 + ky^2)^(3/2) - 16*Iyy*dkx*kx^3*l^5*(kx^2 + ky^2)^(5/2) + 16*Iyy*dkx*kx^5*l^5*(kx^2 + ky^2)^(3/2) - 12*Iyy*dl*kx^4*l^4*(kx^2 + ky^2)^(5/2) - 24*Iyy*dky*ky^3*l^3*(kx^2 + ky^2)^(3/2) + 36*Iyy*dky*ky^5*l^3*(kx^2 + ky^2)^(1/2) - 6*Iyy*dl*ky^4*l^2*(kx^2 + ky^2)^(3/2) + 72*Izz*dky*ky^3*l^3*(kx^2 + ky^2)^(3/2) - 18*Izz*dl*ky^2*l^2*(kx^2 + ky^2)^(5/2) - 240*dkx*kx^3*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 120*dky*ky^3*l*m*sin(l*(kx^2 + ky^2)^(1/2)) + 15*dky*ky^3*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 120*Ixx*dkx*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 15*Ixx*dkx*kx^3*ky^2*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dkx*kx^3*ky^4*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dkx*kx^5*ky^2*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 120*Ixx*dky*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 15*Ixx*dky*kx^2*ky^3*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dky*kx^2*ky^5*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dky*kx^4*ky^3*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 120*Iyy*dkx*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dkx*kx^3*ky^4*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dkx*kx^5*ky^2*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 120*Iyy*dky*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Iyy*dky*kx^2*ky^3*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dky*kx^2*ky^5*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dky*kx^4*ky^3*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 120*Izz*dkx*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 15*Izz*dkx*kx^3*ky^2*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Izz*dky*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 3*Izz*dky*kx^2*ky^3*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*dkx*kx^3*ky^2*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dky*kx^2*ky^3*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dkx*kx*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*dkx*kx*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*dl*kx^2*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*dl*kx^2*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*dky*ky*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*dky*ky*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*dl*kx^4*l^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 12*Ixx*dkx*kx*ky^2*l^3*(kx^2 + ky^2)^(3/2) - 8*Ixx*dkx*kx*ky^2*l^5*(kx^2 + ky^2)^(5/2) - 12*Ixx*dky*kx^2*ky*l^3*(kx^2 + ky^2)^(3/2) - 8*Ixx*dky*kx^2*ky*l^5*(kx^2 + ky^2)^(5/2) + 36*Iyy*dkx*kx*ky^4*l^3*(kx^2 + ky^2)^(1/2) + 16*Iyy*dky*kx^4*ky*l^5*(kx^2 + ky^2)^(3/2) + 72*Izz*dkx*kx*ky^2*l^3*(kx^2 + ky^2)^(3/2) - 72*dkx*kx*ky^2*l*m*sin(l*(kx^2 + ky^2)^(1/2)) + 21*dkx*kx*ky^2*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 288*dky*kx^2*ky*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 6*dky*kx^2*ky*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) + 6*Iyy*dky*ky^5*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Iyy*dl*ky^4*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*Izz*dky*ky^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Izz*dky*ky^3*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*Izz*dl*ky^2*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) - 6*Izz*dl*ky^2*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) + 36*dky*kx^2*ky*l^2*m*(kx^2 + ky^2)^(1/2) + 16*dky*kx^2*ky*l^4*m*(kx^2 + ky^2)^(3/2) + 168*dkx*kx^3*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*dkx*kx^3*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 48*Ixx*dkx*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 6*Ixx*dkx*kx*ky^4*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 48*Ixx*dky*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 6*Ixx*dky*kx^4*ky*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 48*Iyy*dkx*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 21*Iyy*dkx*kx*ky^4*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 48*Iyy*dky*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 120*Izz*dkx*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 15*Izz*dkx*kx*ky^4*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 48*Izz*dky*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 6*Izz*dky*kx^4*ky*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 36*Ixx*dkx*kx^3*ky^2*l^3*(kx^2 + ky^2)^(1/2) + 16*Ixx*dkx*kx^3*ky^2*l^5*(kx^2 + ky^2)^(3/2) + 36*Ixx*dky*kx^2*ky^3*l^3*(kx^2 + ky^2)^(1/2) + 16*Ixx*dky*kx^2*ky^3*l^5*(kx^2 + ky^2)^(3/2) - 6*Ixx*dl*kx^2*ky^2*l^2*(kx^2 + ky^2)^(3/2) - 12*Ixx*dl*kx^2*ky^2*l^4*(kx^2 + ky^2)^(5/2) + 24*dky*kx^4*ky*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 168*dky*kx^2*ky*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*dky*kx^2*ky*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*dl*kx^2*ky^2*l^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 168*Ixx*dkx*kx^3*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Ixx*dkx*kx^3*ky^2*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 168*Ixx*dky*kx^2*ky^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Ixx*dky*kx^2*ky^3*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Ixx*dl*kx^2*ky^2*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 168*Iyy*dkx*kx^3*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 168*Iyy*dky*kx^2*ky^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 48*Ixx*dkx*kx*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 48*Ixx*dky*kx^2*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 48*Iyy*dkx*kx*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*Iyy*dkx*kx*ky^4*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 48*Iyy*dky*kx^2*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*Izz*dkx*kx*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Izz*dkx*kx*ky^2*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*Ixx*dl*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 24*Ixx*dl*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 24*Iyy*dl*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 24*Iyy*dl*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2))/(24*l^2*(kx^2 + ky^2)^(9/2));
C(2,3) = -(3*Ixx*dky*kx^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dky*kx^5*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dky*kx^5*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 9*Iyy*dkx*ky^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Izz*dky*kx^5*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 3*Izz*dky*kx^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 72*Izz*dkx*ky^5*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 9*Izz*dkx*ky^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 72*Izz*dky*kx*l^3*(kx^2 + ky^2)^(5/2) - 36*Izz*dkx*ky*l^3*(kx^2 + ky^2)^(5/2) - 84*dky*kx*l^2*m*(kx^2 + ky^2)^(3/2) - 8*dky*kx*l^4*m*(kx^2 + ky^2)^(5/2) + 72*dkx*ky*l^2*m*(kx^2 + ky^2)^(3/2) + 36*Ixx*dky*kx^3*l^3*(kx^2 + ky^2)^(3/2) - 36*Ixx*dky*kx^5*l^3*(kx^2 + ky^2)^(1/2) - 8*Iyy*dky*kx^3*l^5*(kx^2 + ky^2)^(5/2) - 24*Iyy*dkx*ky^3*l^3*(kx^2 + ky^2)^(3/2) + 36*Iyy*dkx*ky^5*l^3*(kx^2 + ky^2)^(1/2) - 72*Izz*dky*kx^3*l^3*(kx^2 + ky^2)^(3/2) + 72*Izz*dkx*ky^3*l^3*(kx^2 + ky^2)^(3/2) + 168*dky*kx^3*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 9*dky*kx^3*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 120*dkx*ky^3*l*m*sin(l*(kx^2 + ky^2)^(1/2)) + 15*dkx*ky^3*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 120*Ixx*dkx*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 15*Ixx*dkx*kx^2*ky^3*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dkx*kx^2*ky^5*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dkx*kx^4*ky^3*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 96*Ixx*dky*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dky*kx^3*ky^2*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dky*kx^3*ky^4*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 120*Iyy*dkx*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Iyy*dkx*kx^2*ky^3*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dkx*kx^2*ky^5*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dkx*kx^4*ky^3*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 96*Iyy*dky*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 3*Iyy*dky*kx^3*ky^2*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dky*kx^3*ky^4*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Izz*dkx*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 3*Izz*dkx*kx^2*ky^3*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 168*Izz*dky*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 21*Izz*dky*kx^3*ky^2*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 18*Izz*dl*kx*ky*l^2*(kx^2 + ky^2)^(5/2) + 24*dkx*kx^2*ky^3*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dky*kx^3*ky^2*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) - 8*dl*kx*ky*l^3*m*(kx^2 + ky^2)^(5/2) - 72*dky*kx*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*dky*kx*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*dkx*ky*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*dkx*ky*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 12*Ixx*dkx*kx^2*ky*l^3*(kx^2 + ky^2)^(3/2) - 8*Ixx*dkx*kx^2*ky*l^5*(kx^2 + ky^2)^(5/2) - 24*Ixx*dky*kx*ky^2*l^5*(kx^2 + ky^2)^(5/2) + 16*Ixx*dky*kx*ky^4*l^5*(kx^2 + ky^2)^(3/2) + 6*Ixx*dl*kx^3*ky*l^2*(kx^2 + ky^2)^(3/2) - 12*Ixx*dl*kx*ky^3*l^4*(kx^2 + ky^2)^(5/2) + 16*Iyy*dkx*kx^4*ky*l^5*(kx^2 + ky^2)^(3/2) + 48*Iyy*dky*kx*ky^2*l^3*(kx^2 + ky^2)^(3/2) - 72*Iyy*dky*kx*ky^4*l^3*(kx^2 + ky^2)^(1/2) + 8*Iyy*dky*kx*ky^2*l^5*(kx^2 + ky^2)^(5/2) + 6*Iyy*dl*kx*ky^3*l^2*(kx^2 + ky^2)^(3/2) - 12*Iyy*dl*kx^3*ky*l^4*(kx^2 + ky^2)^(5/2) - 144*Izz*dky*kx*ky^2*l^3*(kx^2 + ky^2)^(3/2) - 288*dkx*kx^2*ky*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 6*dkx*kx^2*ky*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 30*dky*kx*ky^2*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dky*kx^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Ixx*dky*kx^5*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 24*Iyy*dky*kx^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*Iyy*dkx*ky^5*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 24*Izz*dky*kx^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*Izz*dky*kx^3*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*Izz*dkx*ky^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Izz*dkx*ky^3*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 36*dkx*kx^2*ky*l^2*m*(kx^2 + ky^2)^(1/2) + 16*dkx*kx^2*ky*l^4*m*(kx^2 + ky^2)^(3/2) + 36*dky*kx*ky^2*l^2*m*(kx^2 + ky^2)^(1/2) + 16*dky*kx*ky^2*l^4*m*(kx^2 + ky^2)^(3/2) - 24*dl*kx*ky*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 3*dl*kx*ky*m*sin(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 48*Ixx*dkx*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 6*Ixx*dkx*kx^4*ky*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 48*Ixx*dky*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dky*kx*ky^6*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 48*Iyy*dkx*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 48*Iyy*dky*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 18*Iyy*dky*kx*ky^4*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dky*kx*ky^6*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 48*Izz*dkx*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 6*Izz*dkx*kx^4*ky*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 144*Izz*dky*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 18*Izz*dky*kx*ky^4*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 36*Ixx*dkx*kx^2*ky^3*l^3*(kx^2 + ky^2)^(1/2) + 16*Ixx*dkx*kx^2*ky^3*l^5*(kx^2 + ky^2)^(3/2) - 72*Ixx*dky*kx^3*ky^2*l^3*(kx^2 + ky^2)^(1/2) - 36*Iyy*dky*kx^3*ky^2*l^3*(kx^2 + ky^2)^(1/2) + 16*Iyy*dky*kx^3*ky^2*l^5*(kx^2 + ky^2)^(3/2) + 24*dkx*kx^4*ky*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dky*kx*ky^4*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 168*dkx*kx^2*ky*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*dkx*kx^2*ky*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 168*dky*kx*ky^2*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*dky*kx*ky^2*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 168*Ixx*dkx*kx^2*ky^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Ixx*dkx*kx^2*ky^3*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 12*Ixx*dky*kx^3*ky^2*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 168*Iyy*dkx*kx^2*ky^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 6*Iyy*dky*kx^3*ky^2*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*dl*kx*ky*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*dl*kx*ky*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 24*Izz*dl*kx*ky*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) + 6*Izz*dl*kx*ky*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) + 12*Ixx*dl*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 12*Ixx*dl*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 12*Iyy*dl*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 12*Iyy*dl*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 24*dl*kx*ky^3*l^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 24*dl*kx^3*ky*l^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 48*Ixx*dkx*kx^2*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 120*Ixx*dky*kx*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 168*Ixx*dky*kx*ky^4*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 6*Ixx*dl*kx^3*ky*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 48*Iyy*dkx*kx^2*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 120*Iyy*dky*kx*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 168*Iyy*dky*kx*ky^4*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 12*Iyy*dky*kx*ky^4*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 6*Iyy*dl*kx*ky^3*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 48*Izz*dky*kx*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 12*Izz*dky*kx*ky^2*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2))/(24*l^2*(kx^2 + ky^2)^(9/2));
C(3,1) = (24*dky*kx^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 3*dky*kx^2*m*sin(2*l*(kx^2 + ky^2)^(1/2)) + 48*dky*ky^2*m*sin(l*(kx^2 + ky^2)^(1/2)) + 8*dky*ky^2*l^3*m*(kx^2 + ky^2)^(3/2) - 72*dl*ky*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 24*dky*ky^4*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dky*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*dky*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*dkx*kx*ky*m*sin(l*(kx^2 + ky^2)^(1/2)) + 3*dkx*kx*ky*m*sin(2*l*(kx^2 + ky^2)^(1/2)) + 48*dl*ky*l^2*m*(kx^2 + ky^2)^(3/2) + 6*Ixx*dky*kx^4*l^2*(kx^2 + ky^2)^(1/2) + 12*Ixx*dky*ky^4*l^4*(kx^2 + ky^2)^(3/2) + 18*Izz*dky*kx^2*l^2*(kx^2 + ky^2)^(3/2) + 24*Ixx*dky*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Ixx*dky*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dky*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dky*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 18*Izz*dkx*kx*ky*l^2*(kx^2 + ky^2)^(3/2) - 24*dky*kx^2*ky^2*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) + 8*dkx*kx*ky*l^3*m*(kx^2 + ky^2)^(3/2) - 24*dky*ky^2*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 6*dky*ky^2*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*dl*ky*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*dl*ky*l^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^2 - 6*Ixx*dkx*kx^3*ky*l^2*(kx^2 + ky^2)^(1/2) + 12*Ixx*dkx*kx*ky^3*l^4*(kx^2 + ky^2)^(3/2) - 6*Iyy*dkx*kx*ky^3*l^2*(kx^2 + ky^2)^(1/2) + 12*Iyy*dkx*kx^3*ky*l^4*(kx^2 + ky^2)^(3/2) - 6*Ixx*dky*kx^4*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 24*Izz*dky*kx^2*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*Izz*dky*kx^2*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 72*dl*ky*l*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 12*Ixx*dkx*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Ixx*dkx*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Iyy*dkx*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2)) - 12*Iyy*dkx*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2)) + 6*Iyy*dky*kx^2*ky^2*l^2*(kx^2 + ky^2)^(1/2) + 12*Iyy*dky*kx^2*ky^2*l^4*(kx^2 + ky^2)^(3/2) - 24*dkx*kx*ky^3*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) - 24*dkx*kx^3*ky*l^2*m*sin(l*(kx^2 + ky^2)^(1/2)) + 72*dl*ky*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Iyy*dky*kx^2*ky^2*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 24*dkx*kx*ky*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 6*dkx*kx*ky*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*Izz*dkx*kx*ky*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Izz*dkx*kx*ky*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*Ixx*dkx*kx^3*ky*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Iyy*dkx*kx*ky^3*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2))/(24*l^2*(kx^2 + ky^2)^(7/2));
C(3,2) = -(24*Ixx*dkx*ky^5*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 9*Ixx*dky*kx^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Iyy*dkx*ky^5*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 3*Iyy*dkx*ky^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 72*Izz*dky*kx^5*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 9*Izz*dky*kx^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Izz*dkx*ky^5*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 3*Izz*dkx*ky^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 36*Izz*dky*kx*l^3*(kx^2 + ky^2)^(5/2) + 72*Izz*dkx*ky*l^3*(kx^2 + ky^2)^(5/2) + 72*dky*kx*l^2*m*(kx^2 + ky^2)^(3/2) - 84*dkx*ky*l^2*m*(kx^2 + ky^2)^(3/2) - 8*dkx*ky*l^4*m*(kx^2 + ky^2)^(5/2) - 24*Ixx*dky*kx^3*l^3*(kx^2 + ky^2)^(3/2) + 36*Ixx*dky*kx^5*l^3*(kx^2 + ky^2)^(1/2) - 8*Ixx*dkx*ky^3*l^5*(kx^2 + ky^2)^(5/2) + 36*Iyy*dkx*ky^3*l^3*(kx^2 + ky^2)^(3/2) - 36*Iyy*dkx*ky^5*l^3*(kx^2 + ky^2)^(1/2) + 72*Izz*dky*kx^3*l^3*(kx^2 + ky^2)^(3/2) - 72*Izz*dkx*ky^3*l^3*(kx^2 + ky^2)^(3/2) - 120*dky*kx^3*l*m*sin(l*(kx^2 + ky^2)^(1/2)) + 15*dky*kx^3*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) + 168*dkx*ky^3*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 9*dkx*ky^3*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 96*Ixx*dkx*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 3*Ixx*dkx*kx^2*ky^3*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dkx*kx^4*ky^3*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 120*Ixx*dky*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Ixx*dky*kx^3*ky^2*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dky*kx^3*ky^4*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dky*kx^5*ky^2*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 96*Iyy*dkx*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dkx*kx^2*ky^3*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dkx*kx^4*ky^3*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 120*Iyy*dky*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 15*Iyy*dky*kx^3*ky^2*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dky*kx^3*ky^4*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dky*kx^5*ky^2*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 168*Izz*dkx*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 21*Izz*dkx*kx^2*ky^3*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Izz*dky*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 3*Izz*dky*kx^3*ky^2*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 18*Izz*dl*kx*ky*l^2*(kx^2 + ky^2)^(5/2) + 24*dkx*kx^2*ky^3*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dky*kx^3*ky^2*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) - 8*dl*kx*ky*l^3*m*(kx^2 + ky^2)^(5/2) + 24*dky*kx*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*dky*kx*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 72*dkx*ky*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*dkx*ky*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 48*Ixx*dkx*kx^2*ky*l^3*(kx^2 + ky^2)^(3/2) - 72*Ixx*dkx*kx^4*ky*l^3*(kx^2 + ky^2)^(1/2) + 8*Ixx*dkx*kx^2*ky*l^5*(kx^2 + ky^2)^(5/2) + 16*Ixx*dky*kx*ky^4*l^5*(kx^2 + ky^2)^(3/2) + 6*Ixx*dl*kx^3*ky*l^2*(kx^2 + ky^2)^(3/2) - 12*Ixx*dl*kx*ky^3*l^4*(kx^2 + ky^2)^(5/2) - 24*Iyy*dkx*kx^2*ky*l^5*(kx^2 + ky^2)^(5/2) + 16*Iyy*dkx*kx^4*ky*l^5*(kx^2 + ky^2)^(3/2) - 12*Iyy*dky*kx*ky^2*l^3*(kx^2 + ky^2)^(3/2) - 8*Iyy*dky*kx*ky^2*l^5*(kx^2 + ky^2)^(5/2) + 6*Iyy*dl*kx*ky^3*l^2*(kx^2 + ky^2)^(3/2) - 12*Iyy*dl*kx^3*ky*l^4*(kx^2 + ky^2)^(5/2) - 144*Izz*dkx*kx^2*ky*l^3*(kx^2 + ky^2)^(3/2) - 30*dkx*kx^2*ky*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 288*dky*kx*ky^2*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 6*dky*kx*ky^2*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) + 6*Ixx*dky*kx^5*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 24*Ixx*dkx*ky^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*Iyy*dkx*ky^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Iyy*dkx*ky^5*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*Izz*dky*kx^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Izz*dky*kx^3*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 24*Izz*dkx*ky^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*Izz*dkx*ky^3*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 36*dkx*kx^2*ky*l^2*m*(kx^2 + ky^2)^(1/2) + 16*dkx*kx^2*ky*l^4*m*(kx^2 + ky^2)^(3/2) + 36*dky*kx*ky^2*l^2*m*(kx^2 + ky^2)^(1/2) + 16*dky*kx*ky^2*l^4*m*(kx^2 + ky^2)^(3/2) - 24*dl*kx*ky*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 3*dl*kx*ky*m*sin(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 48*Ixx*dkx*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 18*Ixx*dkx*kx^4*ky*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dkx*kx^6*ky*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 48*Ixx*dky*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 48*Iyy*dkx*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dkx*kx^6*ky*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 48*Iyy*dky*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 6*Iyy*dky*kx*ky^4*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 144*Izz*dkx*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 18*Izz*dkx*kx^4*ky*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 48*Izz*dky*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 6*Izz*dky*kx*ky^4*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 36*Ixx*dkx*kx^2*ky^3*l^3*(kx^2 + ky^2)^(1/2) + 16*Ixx*dkx*kx^2*ky^3*l^5*(kx^2 + ky^2)^(3/2) - 72*Iyy*dkx*kx^2*ky^3*l^3*(kx^2 + ky^2)^(1/2) + 36*Iyy*dky*kx^3*ky^2*l^3*(kx^2 + ky^2)^(1/2) + 16*Iyy*dky*kx^3*ky^2*l^5*(kx^2 + ky^2)^(3/2) + 24*dkx*kx^4*ky*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dky*kx*ky^4*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 168*dkx*kx^2*ky*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*dkx*kx^2*ky*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 168*dky*kx*ky^2*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*dky*kx*ky^2*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 6*Ixx*dkx*kx^2*ky^3*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 168*Ixx*dky*kx^3*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 12*Iyy*dkx*kx^2*ky^3*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 168*Iyy*dky*kx^3*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Iyy*dky*kx^3*ky^2*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*dl*kx*ky*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*dl*kx*ky*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 24*Izz*dl*kx*ky*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) + 6*Izz*dl*kx*ky*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) + 12*Ixx*dl*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 12*Ixx*dl*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 12*Iyy*dl*kx*ky^5*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 12*Iyy*dl*kx^5*ky*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 24*dl*kx*ky^3*l^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 24*dl*kx^3*ky*l^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 120*Ixx*dkx*kx^2*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 168*Ixx*dkx*kx^4*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 12*Ixx*dkx*kx^4*ky*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 48*Ixx*dky*kx*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Ixx*dl*kx^3*ky*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 120*Iyy*dkx*kx^2*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 168*Iyy*dkx*kx^4*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 48*Iyy*dky*kx*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Iyy*dl*kx*ky^3*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 48*Izz*dkx*kx^2*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 12*Izz*dkx*kx^2*ky*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2))/(24*l^2*(kx^2 + ky^2)^(9/2));
C(3,3) = -(36*dky*ky^3*l^2*m*(kx^2 + ky^2)^(1/2) + 16*dky*ky^3*l^4*m*(kx^2 + ky^2)^(3/2) - 8*dl*ky^2*l^3*m*(kx^2 + ky^2)^(5/2) - 9*Ixx*dkx*kx^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 72*Izz*dkx*kx^5*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 9*Izz*dkx*kx^5*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*dky*ky^5*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dl*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) - 6*dl*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) - 24*dl*kx^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 3*dl*kx^2*m*sin(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 48*dl*ky^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 36*Izz*dkx*kx*l^3*(kx^2 + ky^2)^(5/2) + 72*dkx*kx*l^2*m*(kx^2 + ky^2)^(3/2) + 60*dky*ky*l^2*m*(kx^2 + ky^2)^(3/2) - 8*dky*ky*l^4*m*(kx^2 + ky^2)^(5/2) - 24*Ixx*dkx*kx^3*l^3*(kx^2 + ky^2)^(3/2) + 36*Ixx*dkx*kx^5*l^3*(kx^2 + ky^2)^(1/2) - 6*Ixx*dl*kx^4*l^2*(kx^2 + ky^2)^(3/2) - 16*Ixx*dky*ky^3*l^5*(kx^2 + ky^2)^(5/2) + 16*Ixx*dky*ky^5*l^5*(kx^2 + ky^2)^(3/2) - 12*Ixx*dl*ky^4*l^4*(kx^2 + ky^2)^(5/2) + 72*Izz*dkx*kx^3*l^3*(kx^2 + ky^2)^(3/2) - 18*Izz*dl*kx^2*l^2*(kx^2 + ky^2)^(5/2) - 120*dkx*kx^3*l*m*sin(l*(kx^2 + ky^2)^(1/2)) + 15*dkx*kx^3*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 240*dky*ky^3*l*m*sin(l*(kx^2 + ky^2)^(1/2)) + 120*Ixx*dkx*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 12*Ixx*dkx*kx^3*ky^2*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dkx*kx^3*ky^4*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dkx*kx^5*ky^2*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 120*Ixx*dky*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dky*kx^2*ky^5*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Ixx*dky*kx^4*ky^3*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 120*Iyy*dkx*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 15*Iyy*dkx*kx^3*ky^2*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dkx*kx^3*ky^4*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dkx*kx^5*ky^2*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 120*Iyy*dky*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 15*Iyy*dky*kx^2*ky^3*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dky*kx^2*ky^5*l^4*sin(l*(kx^2 + ky^2)^(1/2)) + 24*Iyy*dky*kx^4*ky^3*l^4*sin(l*(kx^2 + ky^2)^(1/2)) - 24*Izz*dkx*kx^3*ky^2*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 3*Izz*dkx*kx^3*ky^2*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 120*Izz*dky*kx^2*ky^3*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 15*Izz*dky*kx^2*ky^3*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 24*dkx*kx^3*ky^2*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dky*kx^2*ky^3*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 24*dkx*kx*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*dkx*kx*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 24*dky*ky*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*dky*ky*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*dl*ky^2*l*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*dl*ky^2*l*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*dl*ky^4*l^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 16*Ixx*dkx*kx*ky^4*l^5*(kx^2 + ky^2)^(3/2) + 36*Ixx*dky*kx^4*ky*l^3*(kx^2 + ky^2)^(1/2) - 12*Iyy*dkx*kx*ky^2*l^3*(kx^2 + ky^2)^(3/2) - 8*Iyy*dkx*kx*ky^2*l^5*(kx^2 + ky^2)^(5/2) - 12*Iyy*dky*kx^2*ky*l^3*(kx^2 + ky^2)^(3/2) - 8*Iyy*dky*kx^2*ky*l^5*(kx^2 + ky^2)^(5/2) + 72*Izz*dky*kx^2*ky*l^3*(kx^2 + ky^2)^(3/2) - 288*dkx*kx*ky^2*l*m*sin(l*(kx^2 + ky^2)^(1/2)) - 6*dkx*kx*ky^2*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) - 72*dky*kx^2*ky*l*m*sin(l*(kx^2 + ky^2)^(1/2)) + 21*dky*kx^2*ky*l*m*sin(2*l*(kx^2 + ky^2)^(1/2)) + 6*Ixx*dkx*kx^5*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Ixx*dl*kx^4*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*Izz*dkx*kx^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Izz*dkx*kx^3*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*Izz*dl*kx^2*l^2*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) - 6*Izz*dl*kx^2*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(5/2) + 36*dkx*kx*ky^2*l^2*m*(kx^2 + ky^2)^(1/2) + 16*dkx*kx*ky^2*l^4*m*(kx^2 + ky^2)^(3/2) + 168*dky*ky^3*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*dky*ky^3*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 48*Ixx*dkx*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 48*Ixx*dky*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 21*Ixx*dky*kx^4*ky*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 48*Iyy*dkx*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 6*Iyy*dkx*kx*ky^4*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 48*Iyy*dky*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 6*Iyy*dky*kx^4*ky*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 48*Izz*dkx*kx*ky^4*l^2*sin(l*(kx^2 + ky^2)^(1/2)) - 6*Izz*dkx*kx*ky^4*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) - 120*Izz*dky*kx^4*ky*l^2*sin(l*(kx^2 + ky^2)^(1/2)) + 15*Izz*dky*kx^4*ky*l^2*sin(2*l*(kx^2 + ky^2)^(1/2)) + 36*Iyy*dkx*kx^3*ky^2*l^3*(kx^2 + ky^2)^(1/2) + 16*Iyy*dkx*kx^3*ky^2*l^5*(kx^2 + ky^2)^(3/2) + 36*Iyy*dky*kx^2*ky^3*l^3*(kx^2 + ky^2)^(1/2) + 16*Iyy*dky*kx^2*ky^3*l^5*(kx^2 + ky^2)^(3/2) - 6*Iyy*dl*kx^2*ky^2*l^2*(kx^2 + ky^2)^(3/2) - 12*Iyy*dl*kx^2*ky^2*l^4*(kx^2 + ky^2)^(5/2) + 24*dkx*kx*ky^4*l^3*m*sin(l*(kx^2 + ky^2)^(1/2)) + 168*dkx*kx*ky^2*l^2*m*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*dkx*kx*ky^2*l^2*m*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 24*dl*kx^2*ky^2*l^2*m*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 168*Ixx*dkx*kx^3*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 168*Ixx*dky*kx^2*ky^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 168*Iyy*dkx*kx^3*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Iyy*dkx*kx^3*ky^2*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 168*Iyy*dky*kx^2*ky^3*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Iyy*dky*kx^2*ky^3*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) + 6*Iyy*dl*kx^2*ky^2*l^2*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 48*Ixx*dkx*kx*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 48*Ixx*dky*kx^2*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 6*Ixx*dky*kx^4*ky*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2) - 48*Iyy*dkx*kx*ky^2*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 48*Iyy*dky*kx^2*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) + 24*Izz*dky*kx^2*ky*l^3*cos(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 6*Izz*dky*kx^2*ky*l^3*cos(2*l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(3/2) - 24*Ixx*dl*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) - 24*Ixx*dl*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 24*Iyy*dl*kx^2*ky^4*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2) + 24*Iyy*dl*kx^4*ky^2*l^3*sin(l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2))/(24*l^2*(kx^2 + ky^2)^(9/2));
N(1) = (l - l0)*(ke1 - ke2 + ke2*tanh(ke3*(l - l0))^2) - (beta0 - l*(kx^2 + ky^2)^(1/2))*(kx^2 + ky^2)^(1/2)*(kb1 - kb2 + kb2*tanh(kb3*l*(kx^2 + ky^2)^(1/2))^2) - (2*g*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2)/(l^2*(kx^2 + ky^2)) + (g*m*sin(l*(kx^2 + ky^2)^(1/2)))/(l*(kx^2 + ky^2)^(1/2));
N(2) = (g*kx*m*sin(l*(kx^2 + ky^2)^(1/2)))/(kx^2 + ky^2)^(3/2) - (kx*l*(beta0 - l*(kx^2 + ky^2)^(1/2))*(kb1 - kb2 + kb2*tanh(kb3*l*(kx^2 + ky^2)^(1/2))^2))/(kx^2 + ky^2)^(1/2) - (4*g*kx*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2)/(l*(kx^2 + ky^2)^2);
N(3) = (g*ky*m*sin(l*(kx^2 + ky^2)^(1/2)))/(kx^2 + ky^2)^(3/2) - (ky*l*(beta0 - l*(kx^2 + ky^2)^(1/2))*(kb1 - kb2 + kb2*tanh(kb3*l*(kx^2 + ky^2)^(1/2))^2))/(kx^2 + ky^2)^(1/2) - (4*g*ky*m*sin((l*(kx^2 + ky^2)^(1/2))/2)^2)/(l*(kx^2 + ky^2)^2);
F(1) = de*dl;
F(2) = db*dkx;
F(3) = db*dky;

dx(7) = Ae*x(7) + Be*x(5);
dx(8) = Ae*x(8) + Be*x(6);

tau_ = Ce*[0;x(7);x(8)]*0;

ddq = M\(tau_ - C*dq - N - F);

dx(1) = dl;
dx(2) = dkx;
dx(3) = dky;
dx(4) = ddq(1);
dx(5) = ddq(2);
dx(6) = ddq(3);
end

function p = EndEffector(l,kx,ky)
kappa = sqrt(kx.^2 + ky.^2);
theta = atan2(ky,kx); 

sigma = l;
p = (1./kappa).*[(1-cos(kappa.*sigma)).*cos(theta),...
    (1-cos(kappa.*sigma)).*sin(theta),...
    sin(kappa.*sigma)];

end

%----------------------------------------- ODE solver // runge kutta method
function [t,dx] = oderk(f,t,y0)
N = length(t);
F = @(x,y) f(x,y);
y = zeros(length(y0),N);
y(:,1) = y0(:);
h = mean(diff(t));

for i = 1:(N-1)  
    ti = t(i);
    yi = y(:,i);
    
    k1 = F(ti,yi);
    k2 = F(ti+0.5*h,yi+0.5*h*k1);
    k3 = F(ti+0.5*h,yi+0.5*h*k2);
    k4 = F(ti+h,yi+k3*h);
    
    y(:,i+1) = yi + (1/6)*(k1+2*k2+2*k3+k4)*h;  
end

dx = transpose(y);
t = t(:);
end
